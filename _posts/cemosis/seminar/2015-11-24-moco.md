---
layout: seminar_item
title: "Un algorithme numérique pour le transport optimal semi-discret en 3D / A numerical algorithm for semi-discrete optimal transport in 3D"
date: 2015-11-24 14:00:00
location: UFR Math-Info Room 309
author: prudhomm
fullname: Christophe Prud'homme
speaker: "Bruno Lévy (ALICE, Inria-Nancy Grand-Est)"
categories: [seminar]
tags: [cemosis]
---



Dans cette présentation, je m'intéresse au problème du calcul numérique du transport optimal $$L_2$$ en 3d. Étant données deux mesures de probabilités $$\mu$$ et $$\nu$$ supportées par \Omega, le problème consiste à trouver l'application $$T$$ qui pousse $$\mu$$ sur $$\nu$$ et qui minimise le coût de transport $$\int_\Omega \| x - T(x) \|^2 d\mu$$. Des solutions numériques efficaces pour ce problème sont susceptibles de faciliter la simulation de certains phénomènes physiques, tels que l'évolution de la densité de matière à large échelle dans l'univers [Frisch et.al, Nature 2002, Brenier et.al, MNRAS 2003]. Les méthodes numériques utilisées jusqu'à présent optimisent le transport entre deux mesures discrètes (sommes de masses de Diracs), à l'aide d'un algorithme combinatoire, qui passe difficilement à l'échelle au delà de quelques dizaines de milliers de masses de Dirac. Dans le cas où $$\mu$$ a une densité et où $$\nu$$ est discrète (cas "semi-discret"), par une conséquence directe du théorème de décomposition polaire des champs de vecteurs [Brenier 90], la pré-image des masses de Dirac par l'application de transport optimal $$T$$ est une structure bien connue en géométrie algorithmique, à savoir un diagramme de puissance. Les paramètres (poids) de ce diagramme de puissance sont déterminés par le maximum unique d'une fonction concave [Aurenhammer et.al, Algorithmica 1998]. Cette caractérisation aboutit naturellement à un algorithme numérique, qui, combiné avec une approche multi-échelle, permet de calculer efficacement le transport optimal dans le plan [Merigot, Computer Graphics Forum 2011] et de l'appliquer à la résolution en 2d d'équations de type Monge-Ampère (Fokker-Planck, dynamique des foules...) [Benamou et.al, arXiv:1408.4536]. Je montre comment adapter cet algorithme en 3d, dans le cas où $$\mu$$ a une densité linéaire par morceaux, supportée par un maillage tétraédrique et où $$\nu$$ est discrète. Le cœur de l'algorithme calcule l'intersection entre un diagramme de puissance et un maillage tétraédrique par propagation simultanée sur les deux maillages. Les cas dégénérés sont traités par des méthodes de calcul en précision arbitraire [Shewchuk, DCG 97] et par des perturbations symboliques [Edelsbrunner et.al, TOG, 90]. L'implantation parallèle de l'algorithme permet de calculer le transport optimal pour des problèmes de l'ordre du million de masses de Diracs sur un ordinateur personnel de configuration standard. L'implantation de l'algorithme est disponible à l'adresse suivante: http://alice.loria.fr/software/geogram.



In this presentation, I focus on computing $$L_2$$ optimal transport in 3D. Given two probability measures $$\mu$$ and $$\nu$$ supported by $$\Omega$$, the problem consists in finding the application $$T$$ that pushes $$\mu$$ on $$\nu$$ and that minimizes the transport cost $$\int_\Omega \| x -T(x) \|^2 d\mu$$. An efficient numerical solution mechanism for this problem is likely to facilitate the numerical simulation of some phenomena in physics, such as the evolution of the large scale density of matter in the universe [Frisch et.al, Nature 2002, Brenier et.al, MNRAS 2003]. The numerical methods used so far compute the optimal transport between two discrete measures (sums of Dirac masses), using a combinatorial algorithm, that does not scale-up well beyond a few tens of thousands Dirac masses. In the case where $$\mu$$ has a density and $$\nu$$ is discrete ("semi-discrete" case), by a direct consequence of the polar decomposition theorem [Brenier 90], the pre-image of the Dirac masses through the optimal transport map $$T$$ is a structure that is well known in computational geometry, called a power diagram. The parameters that define this power diagram (the weights) are determined as the unique maximum of a concave function [Aurenhammer et.al, Algorithmica 1998]. This characterization naturally leads to a numerical algorithm. Combined with a multi-scale approach, this algorithm makes it possible to efficiently compute the optimal transport in the plane [Merigot, Computer Graphics Forum 2011] and apply it to solving 2d Monge-Ampère type equations (Fokker planck, crowd dynamics, ...) [Benamou et.al, arXiv:1408.4536]. I show how to adapt this algorithm in 3d, in the case where $$\mu$$ has a piecewise-linear density, supported by a tetrahedral mesh, and where $$\nu$$ is discrete. The central part of the algorithm computes the intersection between a power diagram and a tetrahedral mesh by simultaneously propagating over both meshes. Degenerate configurations are handled by arbitrary precision computation methods [Shewchuk, DCG, 97] and symbolic perturbation [Edelsbrunner et.al, TOG, 90]. The parallel implementation of the algorithm computes optimal transport for problems with 1 million Dirac masses on a off-the-shelf PC. The implementation of the algorithm is available at the following address: http://alice.loria.fr/software/geogram
